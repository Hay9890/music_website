{% extends "base.html" %}
{% load static %}

{% block title %}B√†i h√°t y√™u th√≠ch - Django Music App{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- N√∫t quay v·ªÅ trang ch·ªß -->
  <div class="mb-3">
    <a href="{% url 'home' %}" class="btn btn-outline-light">&larr; Quay v·ªÅ trang ch·ªß</a>
  </div>

  <h2 class="mb-4 text-center">B√†i h√°t y√™u th√≠ch</h2>

  {% if favorite_songs %}
    <div class="list-group">
      {% for fav in favorite_songs %}
        <li class="list-group-item list-group-item-dark d-flex align-items-center gap-3 mb-2 py-2 px-3 rounded favorite-song">
          <!-- Avatar -->
          {% if fav.song.cover_image %}
            <img src="{{ fav.song.cover_image.url }}" alt="{{ fav.song.title }}" class="song-avatar">
          {% else %}
            <img src="{% static 'default_cover.jpg' %}" alt="No cover" class="song-avatar">
          {% endif %}

          <!-- Th√¥ng tin b√†i h√°t -->
          <div class="flex-grow-1">
            <strong class="song-title d-block">{{ fav.song.title }}</strong>
            <small class="song-artist d-block mb-1">{{ fav.song.artist.name|default:fav.song.artist }}</small>
            {% if fav.song.audio_file %}
              <audio controls class="w-100 mt-1">
                <source src="{{ fav.song.audio_file.url }}" type="audio/mpeg">
                Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£.
              </audio>
            {% endif %}
          </div>

          <!-- N√∫t b·ªè y√™u th√≠ch -->
          <div class="d-flex flex-column gap-1">
            <form method="post" action="{% url 'add_favorite' %}">
              {% csrf_token %}
              <input type="hidden" name="song" value="{{ fav.song.id }}">
              <button type="submit" class="btn btn-danger btn-sm">üíî B·ªè y√™u th√≠ch</button>
            </form>
          </div>
        </li>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-center text-muted">B·∫°n ch∆∞a c√≥ b√†i h√°t y√™u th√≠ch n√†o. ‚ù§Ô∏è</p>
  {% endif %}

</div>

<style>
.song-avatar {
  width: 50px;
  height: 50px;
  object-fit: cover;
  border-radius: 50%;
}

.song-title {
  font-size: 1.05rem;
  font-weight: 600;
  color: #f8f9fa;
}

.song-artist {
  font-size: 0.9rem;
  color: #dee2e6;
}

.favorite-song {
  border-radius: 12px;
  background-color: #2c2c2c;
}

/* Responsive nh·ªè */
@media (max-width: 576px) {
  .song-avatar {
    width: 40px;
    height: 40px;
  }
  .song-title {
    font-size: 1rem;
  }
  .song-artist {
    font-size: 0.8rem;
  }
}
</style>
{% endblock %}
